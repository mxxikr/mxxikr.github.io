<!-- Performance Optimization -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="dns-prefetch" href="//cdn.jsdelivr.net">
<link rel="dns-prefetch" href="//unpkg.com">

<!-- Critical CSS inline -->
<style>
  /* Critical above-the-fold styles */
  body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;line-height:1.6;color:#333;margin:0;padding:0}
  .container{max-width:1200px;margin:0 auto;padding:0 20px}
  .btn-apple{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:0.875rem 2rem;border-radius:50px;background:radial-gradient(ellipse at 20% 10%,rgba(255,255,255,0.8) 0%,transparent 60%),radial-gradient(ellipse at 80% 90%,rgba(196,190,226,0.4) 0%,transparent 60%);border:1px solid rgba(255,255,255,0.3);color:#424245;font-weight:500;font-size:0.875rem;text-decoration:none;transition:all 0.4s cubic-bezier(0.25,0.46,0.45,0.94);backdrop-filter:blur(30px) saturate(1.2) brightness(1.1);-webkit-backdrop-filter:blur(30px) saturate(1.2) brightness(1.1)}
</style>

<!-- Resource hints -->
<link rel="preload" href="{{ '/assets/css/main.css' | relative_url }}" as="style">
<link rel="preload" href="{{ '/assets/js/apple-liquid-glass.js' | relative_url }}" as="script">

<!-- Lazy loading for images -->
<script>
  if ('loading' in HTMLImageElement.prototype) {
    const images = document.querySelectorAll('img[data-src]');
    images.forEach(img => {
      img.src = img.dataset.src;
      img.removeAttribute('data-src');
    });
  } else {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js';
    document.head.appendChild(script);
    script.onload = () => {
      new LazyLoad();
    };
  }
</script>

<!-- Service Worker registration -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js')
        .then(registration => console.log('SW registered'))
        .catch(error => console.log('SW registration failed'));
    });
  }
</script>

<!-- Performance monitoring -->
<script>
  window.addEventListener('load', () => {
    if ('performance' in window) {
      const perfData = performance.getEntriesByType('navigation')[0];
      const loadTime = perfData.loadEventEnd - perfData.loadEventStart;
      console.log('Page load time:', loadTime + 'ms');
    }
  });
</script>
